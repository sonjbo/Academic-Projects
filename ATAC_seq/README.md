
# ATACSeq Analysis

Independent ATACseq analysis performed as a final project for the bf528 class at Boston University

### Methods

1. **Quality Control of Raw Sequencing Reads**
   - Quality control checks on the raw sequencing reads were performed using FASTQC v0.11.9. The resulting HTML files were reviewed to ensure high-quality data.

2. **Adapter Trimming**
   - Adapters were trimmed from the paired-end reads with Trimmomatic v0.39, using the NexteraPE-PE.fa adapter file and generating separate files for both paired and unpaired reads.

3. **Reference Genome Indexing**
   - The Bowtie2 (v2.4.4) index was built from the reference genome (GRCh38.primary_assembly.genome.fa.gz).

4. **Read Alignment**
   - Trimmed reads were aligned to the indexed reference genome using Bowtie2 v2.4.4 with a -X 2000 flag to report alignments with a minimum score of 2000.

5. **BAM File Processing**
   - Aligned BAM files were sorted and indexed using Samtools v1.15.1, and a flagstat report was generated. Reads mapping to the mitochondrial chromosome (chrM) were filtered out using Samtools view.

6. **Read Shifting**
   - Reads were shifted using alignmentSieve from deepTools v3.5.1 with an --ATACshift flag to account for tagmentation bias.

7. **Fragment Length Distribution Plots**
   - Fragment length distribution plots for each sample were created in R using the fragSizeDist function from the ATACseqQC v1.22.0 package.

8. **Peak Calling**
   - Peaks were called using MACS3 v2.2.7.1 on the shifted BAM files, generating two bed files for each sample.

9. **Reproducible Peaks Generation**
   - One reproducible peaks file was generated by intersecting the summits from replicates with BEDTools, specifying that at least 50% overlap was needed for peaks to be considered reproducible.

10. **Blacklist Filtering**
    - Peaks overlapping regions from the ENCODE blacklist were removed using BEDTools.

11. **Peak Annotation**
    - The remaining peaks were annotated using HOMER's annotatePeaks.pl script, referencing the GENCODE annotation (v45), and a separate directory with gene ontology results was created.

12. **Motif Analysis**
    - Known and de novo motif analysis was conducted using HOMER's findMotifsGenome.pl script.

13. **bigWig File Generation**
    - The DeepTools bamCoverage tool was used to generate bigWig files for nucleosome-free regions (NFR), nucleosome-bound regions (NBR), and mononucleosome fractions.

14. **Coverage Signal Matrix**
    - The coverage signals from NFR, NBR, and mononucleosome bigWig files were summarized into a matrix using the multiBigwigSummary command from deepTools.

15. **Signal Coverage Plot**
    - Signal coverage plots for the three regions centered on the TSS were created for each sample using DeepTools computeMatrix and plotProfile tools.

16. **Summary Tables**
    - A table was compiled detailing alignments before and after filtering reads mapping to the mitochondrial chromosome. Another table summarized the number of peaks called per replicate and the count of reproducible peaks.

17. **Gene Enrichment Analysis**
    - Gene enrichment analysis on the annotated peaks was conducted by creating a dot plot using the GO results for annotated peaks.

18. **Chromatin Accessibility Distribution**
    - The distribution of regions with accessible chromatin (promoter, intergenic, intron, exon, TTS) was visualized in a bar graph.


### Questions Addressed and Deliverables

The following questions were be addressed in this project, and the corresponding deliverables were produced:

### Questions

1. Are there any concerning aspects of the quality control of the sequencing reads or alignment?
2. How many alignments were generated from each sample, and how many mapped to the mitochondrial chromosome?
3. How many peaks are present in each replicate and in the set of reproducible peaks?
4. What are the most enriched GO terms associated with the genes proximal to the reproducible peaks?
5. What can chromatin accessibility inferred from the analysis?

### Deliverables

* A table summarizing the number of alignments before and after filtering the mitochondrial reads.
* Fragment length distribution plot for each sample.
* A signal coverage plot centered on the TSS for NFR and NBR.
* A table containing the number of peaks called in each replicate, the number of reproducible peaks, and the number of peaks remaining after filtering.
* A table or figure summarizing the most interesting results from the motif analysis.
* A table or figure summarizing the most interesting results from the gene enrichment analysis.
* A figure displaying the proportions of peaks overlapping with different genomic features.
* A BED file containing the reproducible peaks.
* R Markdown file summarizing the findings and incorporating all figures and plots.
